import{_ as n,C as l,c as h,o as p,aA as a,j as i,G as e,a as o,w as k}from"./chunks/framework.DxXcxxbP.js";const r="/previews/PR5241/assets/7211125.BjHSboWO.png",d="/previews/PR5241/assets/7211125.BjHSboWO.png",c="/previews/PR5241/assets/aaeba71.-pkpeIqV.png",g="/previews/PR5241/assets/c86c0cc.SFnlM15E.png",E="/previews/PR5241/assets/aaeba71.-pkpeIqV.png",A=JSON.parse('{"title":"DataInspector","description":"","frontmatter":{},"headers":[],"relativePath":"explanations/DataInspector.md","filePath":"explanations/DataInspector.md","lastUpdated":null}'),y={name:"explanations/DataInspector.md"},u={class:"jldocstring custom-block",open:""};function F(b,s,m,f,C,D){const t=l("Badge");return p(),h("div",null,[s[4]||(s[4]=a(`<h1 id="DataInspector" tabindex="-1">DataInspector <a class="header-anchor" href="#DataInspector" aria-label="Permalink to &quot;DataInspector {#DataInspector}&quot;">​</a></h1><h2 id="Basic-Usage" tabindex="-1">Basic Usage <a class="header-anchor" href="#Basic-Usage" aria-label="Permalink to &quot;Basic Usage {#Basic-Usage}&quot;">​</a></h2><p><code>DataInspector</code> provides a way to display tooltips when hovering over plots. By default these tooltips will contain relevant data for plot which is usually the position of the plot element or cursor. To initialize DataInspector it needs to be constructed with an axis-like Block or with a scene. <a id="example-dc6f980"></a></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f, a, p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">..</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2pi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sin)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Makie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><img src="`+r+`" width="600px" height="450px"><div class="tip custom-block"><p class="custom-block-title">Note</p><p><code>DataInspector</code> has been reworked in Makie TODO. It now works per scene rather than globally, uses a new callback syntax for <code>inspector_label</code> and is no longer extended using <code>show_data(...)</code> methods.</p></div><h3 id="Persistent-Tooltips" tabindex="-1">Persistent Tooltips <a class="header-anchor" href="#Persistent-Tooltips" aria-label="Permalink to &quot;Persistent Tooltips {#Persistent-Tooltips}&quot;">​</a></h3><p>DataInspector allows you to make a tooltip persistent by pressing <code>shift</code> and left clicking a plot element. It can later be removed with a <code>shift + left click</code> on the tooltip.</p><h3 id="Custom-Tooltip-Labels" tabindex="-1">Custom Tooltip Labels <a class="header-anchor" href="#Custom-Tooltip-Labels" aria-label="Permalink to &quot;Custom Tooltip Labels {#Custom-Tooltip-Labels}&quot;">​</a></h3><p>DataInspector will check the <code>inspector_label</code> attribute of the hovered plot when building the tooltip. You have three options for setting it. The first is a plain String, which will be displayed when hovering any element of the plot. <a id="example-7211125"></a></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f, a, p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">..</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2pi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sin, inspector_label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;constant label&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Makie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><img src="`+d+`" width="600px" height="450px"><p>The second is an array (or other indexable collection) of strings. This will map the labels to the elements of the plot. For this the plot needs to be discrete like <code>scatter</code> rather than continuous like <code>lines</code>. <a id="example-e361d04"></a></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f, a, p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scatter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inspector_label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Label </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Makie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><img src="`+c+`" width="600px" height="450px"><p>The third option is to manually construct a label from plot data using a callback function. It will be called with a <code>PlotElement</code> and the position of the tooltip. The position should be in the same space as the arguments passed to the function.</p><p>The <code>PlotElement</code> combines the plot with indexing or interpolation information to represent the currently hovered element. When accessing an attribute on a <code>PlotElement</code>, e.g. <code>element.color</code>, the attribute will automatically be indexed or interpolated. <a id="example-c86c0cc"></a></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mylabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element, pos)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# As a discrete plot, scatter elements contain an index.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`element.attribute\`</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# will apply that index when possible so element.color will return the value</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# of the \`color\` attribute at the hovered marker</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	picked_color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">color</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;color = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$picked_color\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pos = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$pos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f,a,p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scatter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), inspector_label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mylabel)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Makie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><img src="`+g+`" width="600px" height="450px"><p>Note that <code>PlotElement</code> also contains the plot type as the first type parameter. If you want to write a whole suite of custom label functions, you can use that for dispatch:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mylabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:Scatter}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pos) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mylabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:Lines}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pos) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mylabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:Hist}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pos) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span></span></code></pre></div><h3 id="Disabling-Tooltips" tabindex="-1">Disabling Tooltips <a class="header-anchor" href="#Disabling-Tooltips" aria-label="Permalink to &quot;Disabling Tooltips {#Disabling-Tooltips}&quot;">​</a></h3><p>Tooltips can be disabled per-plot using the <code>inspectable</code> attribute. When it is set to false DataInspector will not generate a tooltip for the given plot. If there are other plots nearby, tooltips will be generated for the next closest plot. <a id="example-aaeba71"></a></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f, a, p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> scatter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inspectable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Makie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f</span></span></code></pre></div><img src="`+E+'" width="600px" height="450px"><h3 id="Indicators" tabindex="-1">Indicators <a class="header-anchor" href="#Indicators" aria-label="Permalink to &quot;Indicators {#Indicators}&quot;">​</a></h3><p>For some plots DataInspector generates additional &quot;indicators&quot; to highlight the picked element or plot. These can be turned off by setting <code>enable_indicators = false</code> either in DataInspector or in individual plots.</p><h3 id="DataInspector-Attributes" tabindex="-1">DataInspector Attributes <a class="header-anchor" href="#DataInspector-Attributes" aria-label="Permalink to &quot;DataInspector Attributes {#DataInspector-Attributes}&quot;">​</a></h3><p>TODO add docstring, switch to new</p>',29)),i("details",u,[i("summary",null,[s[0]||(s[0]=i("a",{id:"Makie.DataInspector",href:"#Makie.DataInspector"},[i("span",{class:"jlbinding"},"Makie.DataInspector")],-1)),s[1]||(s[1]=o()),e(t,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[3]||(s[3]=a(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(axis; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(scenelike; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create a DataInspector for the given <code>axis</code> or <code>scene</code>-like object. This will enable tooltips for plots within the axis/parent scene.</p><p>If the given axis or scene already has a <code>DataInspector</code> the current one will be returned instead. An existing <code>DataInspector</code> can be deleted by <code>delete!(inspector)</code>.</p><p>Tooltips can be disabled on a per-plot basis by setting <code>inspectable = false</code>. The tooltip string can also be adjusted on a per plot basis using the <code>inspector_label</code> attribute. It can be set to:</p><ul><li><p>a string which is used for every tooltip of the plot</p></li><li><p>a vector of strings where each string maps to an element of the plot. For this</p></li></ul><p>the plot needs to be treated as a discrete visualization (E.g. scatter, but not lines)</p><ul><li>a callback function <code>(element::PlotElement, position) -&gt; string</code> which builds a</li></ul><p>string from the selected <code>PlotElement</code> and position</p><p><strong>Keyword Arguments</strong></p><p>There are keyword arguments for controlling the core DataInspector functionality, the tooltip styling and indicator styling/defaults.</p><p><strong>DataInspector Settings</strong></p><ul><li><code>range = 10</code> sets the (maximum) range of plot picking. This sets the maximum</li></ul><p>distance between the cursor and a plot element for which a tooltip shows up.</p><ul><li><code>tick_priority = 1000</code> sets the priority of the <code>events.tick</code> listener used</li></ul><p>for dynamic/hover tooltips</p><ul><li><code>button_priority = 1000</code> sets the priority of the <code>events.mousebutton</code> listener</li></ul><p>used for persistent tooltips</p><ul><li><code>persistent_tooltip_key = Keyboard.left_shift &amp; Mouse.left</code> sets the key/button</li></ul><p>combination for creating and deleting persistent tooltips</p><ul><li><code>dodge_margins = (30, 30, 30, 30)</code> sets the pixel distance to the</li></ul><p>left/right/bottom/top side of the axis/scene below which the tooltip will change its placement to avoid the edge</p><ul><li><code>show_indicators = true</code> allows disabling all indicators for this DataInspector.</li></ul><p>Note that plots can disable indicators individually by setting <code>show_indicator = false</code>.</p><ul><li><code>blocking = false</code> when set to true tooltip updates block further event processing</li></ul><p>and rendering.</p><ul><li><code>no_tick_discard = false</code> when set to true any tick update triggers a tooltip</li></ul><p>update.</p><p><strong>Indicator Attributes</strong></p><p>Any keyword argument prefixed with <code>indicator_</code> will be sorted into <code>inspector.indicator_attributes</code> without the prefix. These may then be used to style indicator plots. The default attributes are:</p><ul><li><p><code>indicator_color = :red</code></p></li><li><p><code>indicator_linewidth = 2</code></p></li><li><p><code>indicator_linestyle = nothing</code></p></li></ul><p><strong>Tooltip Attributes</strong></p><p>The remaining attributes are sorted into <code>inspector.tooltip_attributes</code> and used when creating dynamic and persistent tooltips. Default attributes include:</p><ul><li><code>draw_on_top = true</code></li></ul><p><strong>Extension</strong></p><p>By default, DataInspector falls back onto known recipes to build tooltips. If that is not enough or produces undesirable results, the various steps in creating a tooltip can be extended. These include:</p><ul><li><code>get_accessor(plot, idx, plot_stack)</code> constructs a accessor which abstracts</li></ul><p>the picked element of a higher level plot. This is used to build the <code>PlotElement</code>.</p><ul><li><p><code>get_tooltip_position(element)</code> returns the position of a <code>PlotElement</code>.</p></li><li><p><code>get_tooltip_label([formatter,] element, position)</code> constructs the displayed</p></li></ul><p>string of the tooltip. Can also return data which will be converted to a string by the formatter.</p><ul><li><code>update_indicator!(inspector, element)</code> updates an indicator to match the</li></ul><p>currently selected plot element.</p><ul><li><code>construct_indicator_plot(inspector, PlotType)</code> creates a plot to be used as</li></ul><p>an indicator</p><p>See the relevant functions for more detail.</p>`,44)),e(t,{type:"info",class:"source-link",text:"source"},{default:k(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/MakieOrg/Makie.jl/blob/60e10f7f9b5ab07cf9ab8f21de5816a2151e35cd/Makie/src/DataInspector/DataInspector.jl#L61-L141",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[5]||(s[5]=a(`<h2 id="Extending-DataInspector" tabindex="-1">Extending DataInspector <a class="header-anchor" href="#Extending-DataInspector" aria-label="Permalink to &quot;Extending DataInspector {#Extending-DataInspector}&quot;">​</a></h2><p>In order for DataInspector to produce useful tooltips for a recipe it may be necessary to extend some of its interface functions.</p><p>Tooltip generation begins with reacting to events which may affect the tooltip. From there <code>pick_sorted(...)</code> is called to find primitive plots around the cursor. They are iterated closest to farthest, calling <code>update_tooltip!(inspector, plot, index)</code> if they are <code>inspectable</code> and within the relevant scene. The <code>update_tooltip!(...)</code> function then attempts to build/update the tooltip.</p><h3 id="pick_element-and-PlotElement-Generation" tabindex="-1"><code>pick_element</code> and PlotElement Generation <a class="header-anchor" href="#pick_element-and-PlotElement-Generation" aria-label="Permalink to &quot;\`pick_element\` and PlotElement Generation {#pick_element-and-PlotElement-Generation}&quot;">​</a></h3><p>The first step converts the primitive plot and index returned by <code>pick_sorted</code> into a <code>PlotElement</code>. The <code>PlotElement</code> abstracts the picked element (e.g. a marker, a point on a line, etc.) of a higher level plot. It primarily contains two parts. The first is a trace of plots from the (user created) recipe plot down to the picked primitive plot. This is referred to as a the plot stack. The other is indexing or interpolation information which is referred to as an accessor.</p><p>Accessors are generated by methods of <code>get_accessor(plot, index, plot_stack)</code> where the <code>plot</code> is the plot to be accessed (typically the root parent), <code>index</code> is the index returned by <code>pick_sorted</code> and <code>plot_stack</code> is the plot stack starting after <code>plot</code>. If no specialized method exists, <code>get_accessor(plot, index, plot_stack)</code> is called with the next lower level plot. Thus you don&#39;t need to implement a method for a recipe plot which has the same element format as its children. For example if a recipe visualizes N discrete elements using child plots that also visualize N discrete elements and the indices don&#39;t get reordered, then the default <code>get_accessor(...)</code> will be enough.</p><p>If the formats do change, a new <code>get_accessor(...)</code> method should implemented. This typically involves getting the result of a lower level plot and transforming it. Let&#39;s consider <code>errorbars</code> as an example. The plot visualizes confidence intervals for discrete data using <code>linesegments</code> for the bars and <code>scatter</code> for the whiskers. Linesegments are considered continuous and both child plots contain two elements (points) per error bar. To generate the appropriate <code>IndexedAccessor</code> we can thus implement the following methods:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_accessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Errorbars, Rangebars}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, idx, plot_stack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple{&lt;:LineSegments, Vararg{Plot}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# Produce the InterpolatedAccessor for the linesegments</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	child_accessor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_accessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">first</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot_stack), index, Base</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tail</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot_stack))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# The InterpolatedAccessor contains indices of type CartesianIndex for the start</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# and end points of the interpolation. These are always the start and end points</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# of bars</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	start_index </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> child_accessor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index0[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	bar_index </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fld1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(start_index, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# An IndexedAccessor also needs the number of discrete elements, i.e. the</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# number of errorbars drawn</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IndexedAccessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bar_index, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val_low_high[]))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_accessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Errorbars, Rangebars}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, idx, plot_stack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple{&lt;:Scatter, Vararg{Plot}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# Scatter already produces an IndexedAccessor so we just need to divide by 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	child_accessor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_accessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">first</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot_stack), index, Base</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tail</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot_stack))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IndexedAccessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fld1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(child_accessor</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val_low_high[]))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>In this case we can further simplify the methods by using the <code>idx</code> from <code>pick</code> directly. For a scatter plot <code>idx</code> is the index of the picked marker. For <code>linesegments</code> it is the index of the start point of a line segment. So in both cases <code>idx</code> is the index we feed to \`fld1(..., 2).</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_accessor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Errorbars, Rangebars}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, idx, plot_stack)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> IndexedElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fld1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(idx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plot</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val_low_high[]))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="get_tooltip_position..." tabindex="-1"><code>get_tooltip_position(...)</code> <a class="header-anchor" href="#get_tooltip_position..." aria-label="Permalink to &quot;\`get_tooltip_position(...)\` {#get_tooltip_position...}&quot;">​</a></h3><p>After generating a <code>PlotElement</code> the tooltip construction continues by getting the position where the tooltip should be anchored. This position is produced by <code>get_tooltip_position(element::PlotElement)</code>. Like with the <code>PlotElement</code> construction this method falls back onto child plots. For this the <code>PlotElement</code> and its accessor are not regenerated, so a new method will be necessary if the accessor is incompatible with child plots.</p><p>Let&#39;s consider <code>errorbars</code> again. An <code>IndexedAccessor</code> works with both child plots, but the fetched positions are incorrect due to the doubling of points. Thus we need to implement a new method to grab the correct ones. For <code>errorbars</code> specifically, <code>val_low_high</code> contains four values, the x and y position, an error downwards and an error upwards. If we want to anchor tooltips at the origin of the errorbar, we can just use the (x, y) position from there.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_tooltip_position</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:Errorbars}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# Using getproperty(element, attribute_name) will automatically</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# apply the accessor to the respective attribute of the parent plot.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# So \`element.attribute\` is equivalent to:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	#	get_plot(element).attribute[][element.index]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	# (if the element is iterable)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	x, y, low, high </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val_low_high</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Point</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, y)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>Note that <code>get_tooltip_position(...)</code> methods should not rely on child plots to generate positions. In order for the position of tooltip to be correct, it also needs to match the <code>space</code> and transformations of the plot which the position comes from. To do that <code>update_tooltip!(...)</code> manually searches for an applicable <code>get_tooltip_position(...)</code> method. It then uses the plot associated with that method to copy <code>space</code> and transformations from.</p><h3 id="Default-labels" tabindex="-1">Default labels <a class="header-anchor" href="#Default-labels" aria-label="Permalink to &quot;Default labels {#Default-labels}&quot;">​</a></h3><p>If no <code>inspector_label</code> is passed to the inspected plot a default tooltip label is generated. It can be adjusted by extending <code>get_default_tooltip_label(formatter, element, position)</code> or <code>get_default_tooltip_label(element, position)</code>. If a string is returned be either method, it is used as the default label. If other data is returned it is converted to a string using the formatter. Like the other two systems this one also falls back onto child plots.</p><p>For our <code>errorbars</code> example we want the tooltip to show errors, i.e. the <code>low, high</code> values from above. The simplest way to do this is to have <code>get_default_tooltip_label()</code> return them:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_default_tooltip_label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:Errorbars}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pos)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	x, y, low, high </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val_low_high</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> low, high</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>This will generate <code>&quot;$low\\n$high&quot;</code> as a string, with <code>low</code> and <code>high</code> truncated to a few significant digits. If we want to improve this we can also construct our own string. We can use <code>&quot;±$low&quot;</code> for symmetric (<code>low == high</code>) and <code>&quot;+$high\\n-$low</code> for asymmetric errorbars like this:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_default_tooltip_label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(formatter, element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:Errorbars}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pos)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x, y, low, high </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val_low_high</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> low </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≈</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> high</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		# apply formatter so numbers continue to get truncated</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;±&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_tooltip_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(formatter, low)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		# Passing a tuple (a, b) results in &quot;$a\\n$b&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;+&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> apply_tooltip_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(formatter, (high, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">low))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="Indicators-2" tabindex="-1">Indicators <a class="header-anchor" href="#Indicators-2" aria-label="Permalink to &quot;Indicators {#Indicators-2}&quot;">​</a></h3><p>Indicators are extra visualizations shown when inspecting specific plots. To add them for a given recipe a specialized method of <code>update_indicator!(...)</code> needs to be implemented. As the name suggests, it should update the indicator plot(s) according to the currently selected element. Let&#39;s look at barplot to give a relatively easy example. Barplot processes user given x positions and heights into discrete bars, represented by 2D rectangles. The <code>PlotElement</code> will select one of these bars/rectangles. To highlight it, we will need to get the rectangle and draw its outline with <code>lines</code>. Since <code>barplot</code> has not yet been updated to use the compute graph, we can&#39;t get the generated rectangles directly from the plot. Instead we need to check the input of the <code>poly</code> child plot.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">poly_element </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> poly_element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arg1</span></span></code></pre></div><p>To draw the outline we need a <code>lines</code> plot. These kinds of plots are cached to avoid constant deletion and re-creation by indicator updates. We can get the cached plot from the DataInspector using <code>get_indicator(inspector, PlotType)</code>. This requires <code>construct_indicator_plot(inspector, PlotType)</code> to exist. For <code>Lines</code> this function already exists and looks like this:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> construct_indicator_plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(di</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Lines}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> di</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inspector_attributes</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        di</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parent, Point3d[], color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">indicator_color,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">indicator_linewidth, linestyle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">indicator_linestyle,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        visible </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inspectable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, depth_shift </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0f-6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>Note that the plot is created with <code>Point3d[]</code>. This fixes the argument type of a vector of 3D points. We can convert our rectangle to that with <code>convert_arguments(...)</code> and <code>to_ndim(...)</code>. The whole <code>update_indicator!(...)</code> then becomes:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> update_indicator!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(di</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataInspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PlotElement{&lt;:BarPlot}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pos)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    poly_element </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(element)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> poly_element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">arg1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> to_ndim</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(Point3d, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">convert_arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Lines, rect)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    indicator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_indicator_plot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(di, Lines)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    update!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(indicator, arg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ps, visible </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div>`,28))])}const w=n(y,[["render",F]]);export{A as __pageData,w as default};
